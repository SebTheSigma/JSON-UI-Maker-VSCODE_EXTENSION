{
  "version": 3,
  "sources": ["../../HTMLScripts/mainScript.ts", "../../HTMLScripts/panel.ts"],
  "sourcesContent": ["import { Panel } from \"./panel.js\";\r\n\r\ndeclare function acquireVsCodeApi(): {\r\n    postMessage: (message: any) => void;\r\n};\r\n\r\nexport const vscode = acquireVsCodeApi();\r\n\r\nexport const container = document.getElementById(\"container\")!;\r\n\r\n// Listen for messages from the extension\r\nwindow.addEventListener(\"message\", (event) => {\r\n    const msg = event.data;\r\n    if (msg.type === \"add_element\") {\r\n        const data: any = msg.data;\r\n        const parentId: string = msg.parentId;\r\n\r\n        switch (data.class) {\r\n            case \"panel\":\r\n                new Panel(data, parentId);\r\n                break;\r\n        }\r\n    } else if (msg.type === \"delete_element\") {\r\n        const elementId = msg.dataID;\r\n        const element = document.querySelector(`[data-id=\"${elementId}\"]`) as HTMLElement | null;\r\n        if (!element) {\r\n            return;\r\n        }\r\n\r\n        const classInstance = WEB_SIDE_GLOBAL_ELEMENT_ID_MAP.get(elementId);\r\n        if (classInstance) {\r\n            classInstance.delete();\r\n        }\r\n    } else if (msg.type === \"get_element_by_dataID\") {\r\n        const elementID = msg.dataID;\r\n        console.warn(\"GETTING ELEMENT\", elementID, msg);\r\n\r\n        const element = document.querySelector(`[data-id=\"${elementID}\"]`) as HTMLElement | null;\r\n        if (!element) {\r\n            console.warn(\"Element not found Error: 01\");\r\n            return;\r\n        }\r\n\r\n        const elementData = {\r\n            tag: element.tagName.toLowerCase(),\r\n            class: element.className,\r\n            dataset: { ...element.dataset },\r\n            style: {\r\n                left: element.style.left,\r\n                top: element.style.top,\r\n                width: element.style.width,\r\n                height: element.style.height,\r\n                zIndex: Number(element.style.zIndex),\r\n            },\r\n            text: element.textContent || \"\",\r\n        };\r\n\r\n        console.warn(\"MESSAGE POSTING\", elementData);\r\n        vscode.postMessage({\r\n            type: \"element\",\r\n            from: msg.from,\r\n            element: elementData,\r\n        });\r\n        console.warn(\"MESSAGE POSTED\");\r\n    }\r\n});\r\n\r\nconst buttons = [\"add_panel\", \"delete_selected\"];\r\n\r\nfor (const button of buttons) {\r\n    const buttonElement = document.getElementById(button)!;\r\n    buttonElement.addEventListener(\"click\", () => {\r\n        vscode.postMessage({\r\n            type: \"button_clicked\",\r\n            id: button,\r\n        });\r\n    });\r\n}\r\n\r\ntype ALL_ELEMENTS = Panel;\r\nexport const WEB_SIDE_GLOBAL_ELEMENT_ID_MAP = new Map<string, ALL_ELEMENTS>();\r\n\r\n\r\n\r\nlet lastWidth = window.innerWidth;\r\nwindow.addEventListener(\"resize\", () => {\r\n    const scale = window.innerWidth / lastWidth;\r\n\r\n    // Update\r\n    lastWidth = window.innerWidth;\r\n    console.log(\"Resized\", scale);\r\n\r\n    // All elements with a data id, so all json-ui elements\r\n    const elements = document.querySelectorAll(\"[data-id]\");\r\n    elements.forEach((el) => {\r\n        const style = (el as HTMLElement).style;\r\n        style.left = `${Number(style.left.replace(/[A-Za-z]/g, \"\")) * scale}px`;\r\n        style.top = `${Number(style.top.replace(/[A-Za-z]/g, \"\")) * scale}px`;\r\n\r\n        style.width = `${Number(style.width.replace(/[A-Za-z]/g, \"\")) * scale}px`;\r\n        style.height = `${Number(style.height.replace(/[A-Za-z]/g, \"\")) * scale}px`;\r\n    });\r\n});\r\n", "import { container, WEB_SIDE_GLOBAL_ELEMENT_ID_MAP, vscode } from \"./mainScript.js\";\r\n\r\nexport class Panel {\r\n    public data: any;\r\n    public parentId: string;\r\n    public el: HTMLElement;\r\n    public parent: HTMLElement;\r\n\r\n    public isDragging = false;\r\n    public initialX = 0;\r\n    public initialY = 0;\r\n    public parentRect: DOMRect;\r\n\r\n    constructor(data: any, parentId: string) {\r\n        this.data = data;\r\n        this.parentId = parentId;\r\n\r\n        this.parent = document.querySelector(`[data-id=\"${parentId}\"]`) ?? container;\r\n        this.parentRect = this.parent.getBoundingClientRect();\r\n\r\n        this.el = document.createElement(\"div\");\r\n        this.el.style.position = \"absolute\";\r\n\r\n        const parentWidth = Number(this.parent?.style.width!.replace(/[A-Za-z]/g, \"\")) || this.parentRect.width;\r\n        const parentHeight = Number(this.parent?.style.height!.replace(/[A-Za-z]/g, \"\")) || this.parentRect.height;\r\n\r\n        this.el.style.zIndex = `${Number(this.parent.style.zIndex) + 1}`;\r\n        this.el.style.width = `${parentWidth * 0.8}px`!;\r\n        this.el.style.height = `${parentHeight * 0.8}px`;\r\n\r\n        this.el.style.left = `${parentWidth * 0.1}px`!;\r\n        this.el.style.top = `${parentHeight * 0.1}px`;\r\n\r\n        this.init();\r\n        this.parent.appendChild(this.el);\r\n\r\n        WEB_SIDE_GLOBAL_ELEMENT_ID_MAP.set(this.data.dataset.id, this);\r\n    }\r\n\r\n    public init() {\r\n        this.asignData();\r\n        this.selectionSystem();\r\n\r\n        this.el.addEventListener(\"mousedown\", (event) => {\r\n            this.startDrag(event);\r\n        });\r\n\r\n        document.addEventListener(\"mouseup\", () => {\r\n            this.stopDrag();\r\n        });\r\n\r\n        document.addEventListener(\"mousemove\", (event) => {\r\n            this.drag(event);\r\n        });\r\n    }\r\n\r\n    public asignData() {\r\n        for (const [key, value] of Object.entries(this.data.style || {})) {\r\n            (this.el.style as any)[key] = value;\r\n        }\r\n        for (const [key, value] of Object.entries(this.data.dataset || {})) {\r\n            (this.el.dataset as any)[key] = value;\r\n        }\r\n\r\n        for (let key of Object.keys(this.data)) {\r\n            if (key === \"style\" || key === \"dataset\") {\r\n                continue;\r\n            }\r\n            (this.el as any)[key] = this.data[key];\r\n        }\r\n    }\r\n\r\n    public selectionSystem() {\r\n        this.el.addEventListener(\"dblclick\", (event) => {\r\n            event.stopPropagation();\r\n            event.preventDefault();\r\n\r\n            console.log(\"Double clicked\");\r\n            if (this.el.classList.contains(\"selected\")) {\r\n                this.el.classList.remove(\"selected\");\r\n\r\n                vscode.postMessage({\r\n                    type: \"element_selection_change\",\r\n                    id: this.data.dataset.id,\r\n                    selected: false,\r\n                });\r\n                return;\r\n            }\r\n\r\n            // Remove selection from all other elements\r\n            const selectedElements = document.querySelectorAll(\".selected\");\r\n            selectedElements.forEach((element) => {\r\n                element.classList.remove(\"selected\");\r\n            });\r\n\r\n            this.el.classList.add(\"selected\");\r\n\r\n            vscode.postMessage({\r\n                type: \"element_selection_change\",\r\n                id: this.data.dataset.id,\r\n                selected: true,\r\n            });\r\n        });\r\n    }\r\n\r\n    public startDrag(event: MouseEvent) {\r\n        event.preventDefault();\r\n        event.stopPropagation();\r\n\r\n        this.parentRect = this.parent.getBoundingClientRect();\r\n        const rect = this.el.getBoundingClientRect();\r\n\r\n        this.isDragging = true;\r\n        this.initialX = event.clientX - rect.left;\r\n        this.initialY = event.clientY - rect.top;\r\n    }\r\n\r\n    public stopDrag() {\r\n        this.isDragging = false;\r\n    }\r\n\r\n    public drag(event: MouseEvent) {\r\n        if (this.isDragging) {\r\n            const deltaX = event.clientX - this.parentRect.left - this.initialX;\r\n            const deltaY = event.clientY - this.parentRect.top - this.initialY;\r\n            this.el.style.left = `${deltaX}px`;\r\n            this.el.style.top = `${deltaY}px`;\r\n            console.log(event.clientX, event.clientY);\r\n        }\r\n    }\r\n\r\n    public delete() {\r\n        if (this.el.classList.contains(\"selected\")) {\r\n            vscode.postMessage({\r\n                type: \"element_selection_change\",\r\n                id: this.data.dataset.id,\r\n                selected: false,\r\n            });\r\n        }\r\n\r\n        this.parent.removeChild(this.el);\r\n\r\n        document.removeEventListener(\"mouseup\", () => {\r\n            this.stopDrag();\r\n        });\r\n\r\n        document.removeEventListener(\"mousemove\", (event) => {\r\n            this.drag(event);\r\n        });\r\n    }\r\n}"],
  "mappings": "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",
  "names": []
}
